<!-- TO DOS

- Calculate the min/max off all data sets (not just first one)
- Figure out how to make the smaller overlapping circle go to top

-->

<head>
  <script src="../d3.v3.min.js" charset="utf-8"></script>
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/style.css">
</head>


<body bgcolor="grey">
  
  <svg width="800" height="350">
    <!-- <circle cx="120" cy="60" r="10"></circle> -->
  </svg>

  <script>

    //ARRAY values
    //<0-6>  : Day of Week, Y Axis Value,
    //<0-23> : Hour of Day, X Axis Value,
    //<n>    : Number of commits, Z Axis Value / Circle weight
    // example value: [0,8,2]

    var opts = {
      maxRadius: 15,
      minRadius: 5
    }

    var range = opts.maxRadius - opts.minRadius;
    var shift = opts.maxRadius - range;

    function calcMax(data){
      var max = 0;
      for (var i=0; i<data.length; i++){
        if (data[i][2] > max){
          max = data[i][2];
        }
      }
      return max;
    }

    function calcMin(data){
      var min;
      for (var i=0; i<data.length; i++){
        if (data[i][2] < min || typeof min === 'undefined'){
          min = data[i][2];
        }
      }
      return min;
    }



    var days = 7;
    var hours = 24;

    var svg = d3.select("svg");
    var width = parseInt( svg.style('width') );
    var height = parseInt( svg.style('height') );

    var wx = width / hours;
    var hx = height / days;

    var data = [[0,0,2],[0,23,5],[2,12,5],[6,23,2],[6,22,8],[6,1,3],[3,14,5],[3,15,2],[3,16,8],[3,18,5]];
    var data2 = [[1,3,5],[1,23,4],[2,13,7],[5,22,2],[5,7,2],[5,8,10],[5,21,8],[4,4,3],[3,15,5],[2,12,2],[4,16,8],[3,13,5]];
    

    



    function addCircles(data, color){
      var dataMax = calcMax(data);
      var dataMin = calcMin(data);

      //create the circles
      var circle = svg.selectAll()
                      .data(data)
                      .enter().append('circle');

      circle.attr('cy', function(d){
        return( d[0] * hx + (hx / 2) );
        //return d[0]
      });
      circle.attr('cx', function(d){
        return( d[1] * wx + (wx / 2) );
        //return d[0]
      });
      circle.attr('r', 0).transition().attr('r', function(d){
        var radius = (d[2] / dataMax * range) + shift;
        if (radius == shift){
          return;
        }
        return radius;
      });

      circle.attr('stroke', color)
            .attr('stroke-width', 1)
            //.attr('fill-opacity', 0.1);
      circle.style({
        fill: color,
      });
    }
    
    addCircles(data, 'red')
    addCircles(data2, 'black')




    /*var circle = d3.selectAll('circle');
    circle.style('fill','steelblue')
    circle.attr('r', 30)
    circle.attr('cx', function(){
      return Math.ceil(Math.random()*720);
    })

    circle.data([32, 57, 112]);
    circle.attr("r", function(d) { return Math.sqrt(d); });
    circle.attr('cx', function(d,i){ return i * 100 + 30} );
    

    var svg = d3.select('svg');
    var circle = svg.selectAll('circle')
                    .data([32, 57, 112, 293]);

    var circleEnter = circle.enter().append('circle')

    circleEnter.attr("cy", 60);
    circleEnter.attr("cx", function(d, i) { return i * 100 + 30; });
    circleEnter.attr("r", function(d) { return Math.sqrt(d); });
    circle.style('fill','steelblue');*/


  </script>

</body>